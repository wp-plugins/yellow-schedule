jQuery(document).ready(function($) {
	$('#ys_act_connect_btn').click(function() {
		$('#wpt_ys_connect_error').hide();
		$('#wpt_ys_qs_error').hide();
		$('#ys_login_button').text("Connect Account");
		$('#wpt_ys_username').val("");
		$('#wpt_ys_password').val("");
	});
	$('#ys_master_act').prop('disabled', false);
	$('#ys_login_button').click(function() {
		$.ajax({url: 'https://www.yellowschedule.com/_json/plugins/getBusKey.php',
		data: {source : 'wp', u : $('#wpt_ys_username').val(), p : $('#wpt_ys_password').val()},
		type: 'post', 
		async: 'true',
		dataType: 'json',
		beforeSend: function() {
			// This callback function will trigger before data is sent
			$('#ys_login_button').text("Loading...");
		},
		complete: function() {
			// This callback function will trigger on data sent/received complete
			
		},
		success: function (result) {
				if(result.status) {
					if(result.qs_required_and_not_completed == 0) {
						$('#wpt_ys_connect_error').hide();
						$('#wpt_ys_qs_error').hide();
						window.location.search = '?page=yellow_schedule_settings&account_connect='+result.business_key;
					}
					else {
						$('#wpt_ys_qs_error').show();
						$('#ys_login_button').text("Connect Account");
					}
					
				} else {
					$('#wpt_ys_connect_error').show();
					$('#ys_login_button').text("Connect Account");
				}
		},
		error: function (request,error) {
			// This callback function will trigger on unsuccessful action               
			alert("A parsing or network error has occured");
		}
		});                  	 
		return false; // cancel original event to prevent form submitting
	});
});